<!doctype html><html lang=pt-BR><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="criação de uma maquina virtual android (AVD/Simulador) no linux"><meta name=author content="Bruno Rozendo"><meta name=keywords content><title>Criar AVD (Simulador Android) por linha de comando no Gnu/Linux -- Bruno Rozendo</title><link href=//css/bootstrap.min.css rel=stylesheet><link href=//css/clean-blog.min.css rel=stylesheet><link rel=stylesheet type=text/css href=/css/custom.css><link href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css rel=stylesheet><link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel=stylesheet><link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel=stylesheet></head><body><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle data-toggle=collapse data-target=#bs-example-navbar-collapse-1>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=navbar-brand href=/>Bruno Rozendo</a></div><div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1><ul class="nav navbar-nav navbar-right"><li><a href=/>home</a></li><li><a href=/contact.html>Contact</a></li><li><a href=/posts.html>Posts</a></li></ul></div></div></nav><header class=intro-header style=background-image:url(///images/posts/criar-avd-gnu-linux/banner.jpg)><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>Criar AVD (Simulador Android) por linha de comando no Gnu/Linux</h1><h2 class=subheading>criação de uma maquina virtual android (AVD/Simulador) no linux</h2><span class=meta>Posted by <a href=#>Bruno Rozendo</a> on Wed, Feb 16, 2022<br>In<br>Tags <a href=/tags/android>android</a>, <a href=/tags/gnu/linux>gnu/linux</a>, <a href=/tags/avd>avd</a>, <a href=/tags/android-na-ra%C3%A7a>android na raça</a></span></div></div></div></div><div class="container-fluid imagecredit"><div class=row><div class=".col-sm text-right"><a href=http://www.freepik.com>Designed by ijeab / Freepik</a></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><table class="table table-striped"><thead><tr><th>rev.</th><th>data</th></tr></thead><tbody><tr><td>1 revisão</td><td>26/07/2017</td></tr><tr><td>2 revisão</td><td>16/02/2022</td></tr></tbody></table><h4 id=prequisitos>Prequisitos</h4><p>Ter o <a href=/post/instalar-adroid-sdk-gnu-linux.html>android sdk instalado</a></p><h4 id=1-criar-avd>1. Criar avd</h4><p>Uma vez que que já tenha instalado o sdk tudo fica bem mais fácil.</p><p>Supondo que queremos rodar uma versão do <code>Android 5.0 (Lollipop)</code> abra o terminal e vamos instalar os seguites pacotes:</p><ul><li><code>platforms;android-22</code></li><li><code>system-images;android-22;default;x86_64</code></li><li><code>emulator</code></li><li><code>platform-tools</code></li></ul><p>No terminal</p><div class=terminal><div class=header><img src=//images/layouts/shortcodes/terminal.png alt><div class=title>Terminal</div></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sdkmanager <span style=color:#e6db74>&#34;platforms;android-22&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[=======================================]</span> 100% Computing updates...
</span></span><span style=display:flex><span>$ sdkmanager <span style=color:#e6db74>&#34;system-images;android-22;default;x86_64&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[=======================================]</span> 100% Computing updates...
</span></span><span style=display:flex><span>$ sdkmanager <span style=color:#e6db74>&#34;emulator&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[=======================================]</span> 100% Unzipping... emulator/qemu/linux-
</span></span><span style=display:flex><span>$ sdkmanager <span style=color:#e6db74>&#34;platform-tools&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[=======================================]</span> 100% Unzipping... platform-tools/systr</span></span></code></pre></div></div><p>** Caso queira ver todas as opções possiveis digite no terminal</p><div class=terminal><div class=header><img src=//images/layouts/shortcodes/terminal.png alt><div class=title>Terminal</div></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sdkmanager --list --verbose</span></span></code></pre></div></div><p>Agora vamos criar o própriamente o <code>avd</code>. Ponha no terminal:</p><div class=terminal><div class=header><img src=//images/layouts/shortcodes/terminal.png alt><div class=title>Terminal</div></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ avdmanager create avd<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> -n bruno<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> -k <span style=color:#e6db74>&#34;system-images;android-22;default;x86_64&#34;</span><span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> --device <span style=color:#e6db74>&#34;Nexus 5&#34;</span><span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> --sdcard 100M</span></span></code></pre></div></div><p>** Caso queira ver todas as opções device possiveis digite no terminal</p><div class=terminal><div class=header><img src=//images/layouts/shortcodes/terminal.png alt><div class=title>Terminal</div></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ avdmanager list device</span></span></code></pre></div></div><h4 id=2-skins>2. Skins</h4><p>No Android Studio existem algumas <a href=https://developer.android.com/studio/run/managing-avds.html#skins>skins</a> disponíveis.</p><p>Como esse tutorial é na raça (tudo na mão), não teriamos esses disponiveis, mas calma, para tudo na vida tem jeito.</p><div class=terminal><div class=header><img src=//images/layouts/shortcodes/terminal.png alt><div class=title>Terminal</div></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cd  $ANDROID_HOME
</span></span><span style=display:flex><span>$ git clone https://github.com/brunorozendo/android-skins.git skins</span></span></code></pre></div></div><p>Pronto agora essas skins estão de fácil acesso.</p><h4 id=3-excutar-o-avd-com-o-emulator>3. Excutar o AVD com o EMULATOR</h4><div class=terminal><div class=header><img src=//images/layouts/shortcodes/terminal.png alt><div class=title>Terminal</div></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> emulator<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> -avd bruno<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> -skindir <span style=color:#e6db74>&#34;</span>$ANDROID_HOME<span style=color:#e6db74>/skins&#34;</span><span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> -skin <span style=color:#e6db74>&#34;nexus_5&#34;</span><span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> -memory 4096<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> -accel on<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> -gpu on</span></span></code></pre></div></div><p>e <em>voilá</em> temos um adroid rodando.</p><figure><img src=/images/posts/criar-avd-gnu-linux/avd.png></figure><p>Clique no <strong>X</strong> para fechar o simulador.</p><p>Agora vamos deixa esse emulador usavel!</p><ul><li><p>Unable to connect to adb daemon on port: 5037</p><p>Ao executar o comando acima o log deve ter sido algo parecido</p><div class=terminal><div class=header><img src=//images/layouts/shortcodes/terminal.png alt><div class=title>Terminal</div></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> $ emulator<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>   -avd bruno<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>   -skindir <span style=color:#e6db74>&#34;</span>$ANDROID_HOME<span style=color:#e6db74>/skins&#34;</span><span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>   -skin <span style=color:#e6db74>&#34;nexus_5&#34;</span><span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>   -memory 4096<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>   -accel on<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>   -gpu on
</span></span><span style=display:flex><span>   INFO    | Android emulator version 31.2.8.0 <span style=color:#f92672>(</span>build_id 8143646<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>CL:N/A<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   WARNING | encryption is off
</span></span><span style=display:flex><span>   Fontconfig warning: <span style=color:#e6db74>&#34;/usr/share/fontconfig/conf.avail/05-reset-dirs-sample.conf&#34;</span>, line 6: unknown element <span style=color:#e6db74>&#34;reset-dirs&#34;</span>
</span></span><span style=display:flex><span>   INFO    | configAndStartRenderer: setting vsync to <span style=color:#ae81ff>60</span> hz
</span></span><span style=display:flex><span>   WARNING | cannot add library /opt/android/sdk-android-linux/emulator/qemu/linux-x86_64/lib64/vulkan/libvulkan.so: failed
</span></span><span style=display:flex><span>   INFO    | added library /opt/android/sdk-android-linux/emulator/lib64/vulkan/libvulkan.so
</span></span><span style=display:flex><span>   host doesn<span style=color:#e6db74>&#39;t support requested feature: CPUID.80000001H:ECX.abm [bit 5]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   host doesn&#39;</span>t support requested feature: CPUID.80000001H:ECX.abm <span style=color:#f92672>[</span>bit 5<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>   host doesn<span style=color:#e6db74>&#39;t support requested feature: CPUID.80000001H:ECX.abm [bit 5]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   host doesn&#39;</span>t support requested feature: CPUID.80000001H:ECX.abm <span style=color:#f92672>[</span>bit 5<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>   pc_memory_init: above 4g size: <span style=color:#ae81ff>40000000</span>
</span></span><span style=display:flex><span>   INFO    | Started GRPC server at 127.0.0.1:8554, security: Local
</span></span><span style=display:flex><span>   INFO    | Advertising in: /run/user/1000/avd/running/pid_6979.ini
</span></span><span style=display:flex><span>   ERROR   | Unable to connect to adb daemon on port: <span style=color:#ae81ff>5037</span>
</span></span><span style=display:flex><span>   INFO    | Your emulator is out of date, please update by launching Android Studio:
</span></span><span style=display:flex><span>   - Start Android Studio
</span></span><span style=display:flex><span>     - Select menu <span style=color:#e6db74>&#34;Tools &gt; Android &gt; SDK Manager&#34;</span>
</span></span><span style=display:flex><span>     - Click <span style=color:#e6db74>&#34;SDK Tools&#34;</span> tab
</span></span><span style=display:flex><span>     - Check <span style=color:#e6db74>&#34;Android Emulator&#34;</span> checkbox
</span></span><span style=display:flex><span>     - Click <span style=color:#e6db74>&#34;OK&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   INFO    | Shutting down gRPC endpoint
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   </span></span></code></pre></div></div><p>O que nos importa no momento é a seguinte linha</p><p><code>ERROR | Unable to connect to adb daemon on port: 5037</code></p><p>então para resolver isso</p><div class=terminal><div class=header><img src=//images/layouts/shortcodes/terminal.png alt><div class=title>Terminal</div></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> $ adb start-server </span></span></code></pre></div></div><p>Ao executar novamente o simulador essa mensagem deve ter desaparecido:</p><div class=terminal><div class=header><img src=//images/layouts/shortcodes/terminal.png alt><div class=title>Terminal</div></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> $ emulator -avd bruno -skindir <span style=color:#e6db74>&#34;</span>$ANDROID_HOME<span style=color:#e6db74>/skins&#34;</span> -skin <span style=color:#e6db74>&#34;nexus_5&#34;</span> -memory <span style=color:#ae81ff>4096</span> -accel on -gpu on
</span></span><span style=display:flex><span>   INFO    | Android emulator version 31.2.8.0 <span style=color:#f92672>(</span>build_id 8143646<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>CL:N/A<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   WARNING | encryption is off
</span></span><span style=display:flex><span>   Fontconfig warning: <span style=color:#e6db74>&#34;/usr/share/fontconfig/conf.avail/05-reset-dirs-sample.conf&#34;</span>, line 6: unknown element <span style=color:#e6db74>&#34;reset-dirs&#34;</span>
</span></span><span style=display:flex><span>   INFO    | configAndStartRenderer: setting vsync to <span style=color:#ae81ff>60</span> hz
</span></span><span style=display:flex><span>   WARNING | cannot add library /opt/android/sdk-android-linux/emulator/qemu/linux-x86_64/lib64/vulkan/libvulkan.so: failed
</span></span><span style=display:flex><span>   INFO    | added library /opt/android/sdk-android-linux/emulator/lib64/vulkan/libvulkan.so
</span></span><span style=display:flex><span>   host doesn<span style=color:#e6db74>&#39;t support requested feature: CPUID.80000001H:ECX.abm [bit 5]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   host doesn&#39;</span>t support requested feature: CPUID.80000001H:ECX.abm <span style=color:#f92672>[</span>bit 5<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>   host doesn<span style=color:#e6db74>&#39;t support requested feature: CPUID.80000001H:ECX.abm [bit 5]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   host doesn&#39;</span>t support requested feature: CPUID.80000001H:ECX.abm <span style=color:#f92672>[</span>bit 5<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>   pc_memory_init: above 4g size: <span style=color:#ae81ff>40000000</span>
</span></span><span style=display:flex><span>   INFO    | Started GRPC server at 127.0.0.1:8554, security: Local
</span></span><span style=display:flex><span>   INFO    | Advertising in: /run/user/1000/avd/running/pid_7658.ini
</span></span><span style=display:flex><span>   INFO    | Shutting down gRPC endpoint
</span></span><span style=display:flex><span>   </span></span></code></pre></div></div></li><li><p>Caso tenho feito alguns teste você deve ter percebido que o teclado não está fucionando vamos resolver isso.</p><p>Feche novamente o simulador.</p><p>Dentro da pasta <code>~/.android/avd</code> deve existir o emulador ( caso esteja usando a variável <code>ANDROID_AVD_HOME</code> então procure dentro dela) e vamos editar o arquivio</p><p><code>bruno.avd/config.ini</code></p><p>Procure pela linha <code>hw.keyboard=no</code> e substitua por <code>hw.keyboard=yes</code></p><p>** <a href=https://stackoverflow.com/questions/3391160/paste-text-on-android-emulator>Ctrl+C/Ctrl+V não é possivel com o teclado, mas há outras maneiras</a>.</p></li><li><p>É possivel já deixar a <code>skin</code> configurada, para isso, busque pela linha <code>skin.path=_no_skin</code> e substitua, no caso ficou assim</p><p><code>skin.path=/opt/android/sdk-android-linux/skins/nexus_5</code></p></li><li><p>GPU: igual a skin, busque pela linha <code>hw.gpu.enabled=no</code> e substitua por <code>hw.gpu.enabled=true</code></p></li><li><p>Ram: igual a skin, busque pela linha <code>hw.ramSize</code> e substitua por <code>hw.ramSize=4096M</code></p></li></ul><p>Agora o novo comando para iniciar o simulador</p><div class=terminal><div class=header><img src=//images/layouts/shortcodes/terminal.png alt><div class=title>Terminal</div></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> $emulator -avd bruno -accel on</span></span></code></pre></div></div><figure><img src=/images/posts/criar-avd-gnu-linux/final.png></figure><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//brunoozendo.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div></article><hr><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href=mailto:bruno@brunorozendo.com><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i>
<i class="fa fa-envelope-o fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://github.com/brunorozendo><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i>
<i class="fa fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Code released under the Apache 2.0 license.</p></div></div></div></footer><script src=//js/jquery.min.js></script><script src=//js/bootstrap.min.js></script><script src=//js/clean-blog.js></script></body></html>